<!DOCTYPE html>
<html lang="fr" data-theme="light">

<head>
    <!-- Analytics managed by CookieManager in app.js -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/svg+xml" href="favicon.svg">

    <!-- Security Headers -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
    <meta http-equiv="Permissions-Policy"
        content="geolocation=(), microphone=(), camera=(), payment=(), usb=(), magnetometer=(), gyroscope=(), accelerometer=()">
    <!-- Content Security Policy - Maximum Protection -->
    <meta http-equiv="Content-Security-Policy" content="
        default-src 'self';
        script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com https://www.googletagmanager.com https://*.googletagmanager.com https://www.google-analytics.com https://*.google-analytics.com;
        style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
        font-src 'self' https://fonts.gstatic.com;
        img-src 'self' data: https:;
        connect-src 'self' https://*.supabase.co https://www.google-analytics.com https://*.google-analytics.com https://www.googletagmanager.com https://*.googletagmanager.com;
        frame-src 'none';
        object-src 'none';
        base-uri 'self';
        form-action 'self';
        upgrade-insecure-requests;
    ">
    <!-- X-XSS-Protection (legacy but still useful) -->
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">

    <title>Isaiah ‚Äî Dis-le. Gu√©ris.</title>
    <meta name="description"
        content="Isaiah - Une plateforme √©pur√©e pour partager vos √©crits personnels. Po√©sie, fiction, essais et r√©flexions.">

    <!-- Open Graph / Social Media -->
    <meta property="og:title" content="Isaiah ‚Äî Dis-le. Gu√©ris.">
    <meta property="og:description"
        content="Une plateforme d'√©criture intime o√π les mots deviennent th√©rapie. Partagez vos po√®mes, fictions et r√©flexions.">
    <meta property="og:image" content="https://ibrahim0899.github.io/Isaiah/affiche_oniyah_portrait.png">
    <meta property="og:url" content="https://ibrahim0899.github.io/Isaiah/">
    <meta property="og:type" content="website">
    <meta property="og:locale" content="fr_FR">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Isaiah ‚Äî Dis-le. Gu√©ris.">
    <meta name="twitter:description" content="Une plateforme d'√©criture intime o√π les mots deviennent th√©rapie.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Crimson+Pro:ital,wght@0,400;0,500;0,600;1,400;1,500&family=Inter:wght@400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="styles.css">

    <!-- DOMPurify for XSS Protection -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.0.6/purify.min.js" crossorigin="anonymous"
        referrerpolicy="no-referrer"></script>
    <!-- Google Tag Manager managed by CookieManager in app.js -->
</head>

<body>


    <!-- Header -->
    <header class="header">
        <div class="header-container">
            <a href="#" class="logo" data-page="home">
                <svg class="logo-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 19l7-7 3 3-7 7-3-3z" />
                    <path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z" />
                    <path d="M2 2l7.586 7.586" />
                    <circle cx="11" cy="11" r="2" />
                </svg>
                <span class="logo-text">Isaiah</span>
            </a>
            <nav class="nav">
                <button class="nav-link active" data-page="home">Biblioth√®que</button>
                <button class="nav-link" data-page="write" style="display:none">√âcrire</button>
                <button class="nav-link" data-page="profile" style="display:none">Profil</button>
            </nav>
            <div class="search-container">
                <div class="search-box">
                    <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8" />
                        <path d="M21 21l-4.35-4.35" />
                    </svg>
                    <input type="text" id="searchInput" class="search-input" placeholder="Rechercher des √©crivains..."
                        autocomplete="off">
                </div>
                <div class="search-results hidden" id="searchResults">
                    <!-- Search results will appear here -->
                </div>
            </div>
            <div class="header-actions">
                <button class="theme-toggle" id="themeToggle" aria-label="Changer le th√®me">
                    <svg class="sun-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="5" />
                        <path
                            d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" />
                    </svg>
                    <svg class="moon-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" />
                    </svg>
                </button>
                <button class="auth-btn" id="authBtn" title="Connexion / Inscription"
                    aria-label="Connexion ou Inscription">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
                        <circle cx="12" cy="7" r="4" />
                    </svg>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main">
        <!-- Landing Page (for non-logged users) -->
        <section id="page-landing" class="page active">
            <div class="landing-hero">
                <div class="landing-content">
                    <h1 class="landing-title">Dis-le. Gu√©ris.</h1>
                    <p class="landing-subtitle">
                        Isaiah est un espace d'√©criture intime o√π les mots deviennent th√©rapie.
                        Partagez vos √©crits, d√©couvrez des plumes inspirantes et rejoignez une communaut√© d'√©crivains.
                    </p>
                    <div class="landing-cta">
                        <button class="btn btn-primary btn-lg" id="landingAuthBtn">Commencer √† √©crire</button>
                        <button class="btn btn-ghost btn-lg" id="exploreBtn">D√©couvrir les √©crits</button>
                    </div>

                    <!-- Hero Featured Writings -->
                    <div class="hero-featured-writings" id="heroFeaturedWritings">
                        <!-- First 2 writings will be inserted here dynamically -->
                    </div>
                </div>
            </div>

            <!-- What is Isaiah -->
            <div class="landing-section">
                <h2 class="section-title">Qu'est-ce qu'Isaiah ?</h2>
                <p class="section-text">
                    Isaiah est une plateforme d'√©criture cr√©√©e par <strong>Ibrahim Isaiah NIASS</strong>.
                    Un refuge pour ceux qui cherchent √† exprimer leurs pens√©es, leurs douleurs, leurs joies
                    √† travers l'√©criture. Ici, chaque mot compte.
                </p>
            </div>

            <!-- Features -->
            <div class="landing-section">
                <h2 class="section-title">Ce que vous pouvez faire</h2>
                <div class="features-grid">
                    <div class="feature-card">
                        <div class="feature-icon">‚úçÔ∏è</div>
                        <h3>√âcrire</h3>
                        <p>Publiez vos po√®mes, fictions, essais et r√©flexions dans un √©diteur √©l√©gant.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üë•</div>
                        <h3>Suivre</h3>
                        <p>Abonnez-vous aux √©crivains qui vous inspirent pour ne rien manquer.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üîí</div>
                        <h3>Contr√¥ler</h3>
                        <p>Choisissez qui peut voir vos √©crits : public ou priv√©.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üí´</div>
                        <h3>D√©couvrir</h3>
                        <p>Explorez de nouvelles plumes et laissez-vous inspirer.</p>
                    </div>
                </div>
            </div>

            <!-- Featured Writings (Admin's public texts) -->
            <div class="landing-section" id="featuredSection">
                <h2 class="section-title">üìñ D√©couvrez plus d'√©crits</h2>
                <p class="section-subtitle">par Ibrahim Isaiah NIASS</p>
                <div class="writings-grid" id="featuredWritings">
                    <!-- Additional featured writings will be inserted here -->
                </div>
            </div>

            <!-- Discover Writers -->
            <div class="landing-section" id="discoverSection">
                <h2 class="section-title">‚ú® D√©couvrez des √©crivains</h2>
                <div class="writers-grid" id="writersGrid">
                    <!-- Writers suggestions will be inserted here -->
                </div>
            </div>
        </section>

        <!-- Library Page (for logged users) -->
        <section id="page-home" class="page">
            <div class="page-header">
                <div>
                    <h1 class="page-title">Ma Biblioth√®que</h1>
                    <p class="page-subtitle">Les √©crits de vos abonnements</p>
                </div>
                <button class="btn btn-primary" id="newWritingBtn">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 5v14M5 12h14" />
                    </svg>
                    Nouvel √âcrit
                </button>
            </div>

            <!-- Filters -->
            <div class="filters">
                <div class="filter-group">
                    <button class="filter-btn active" data-filter="category" data-value="all">Tous</button>
                    <button class="filter-btn" data-filter="category" data-value="poetry">Po√©sie</button>
                    <button class="filter-btn" data-filter="category" data-value="fiction">Fiction</button>
                    <button class="filter-btn" data-filter="category" data-value="essay">Essai</button>
                    <button class="filter-btn" data-filter="category" data-value="reflection">R√©flexion</button>
                </div>
                <div class="filter-group" data-admin-only>
                    <button class="filter-btn" data-filter="visibility" data-value="all">üìñ Tous</button>
                    <button class="filter-btn" data-filter="visibility" data-value="public">üåç Publics</button>
                    <button class="filter-btn" data-filter="visibility" data-value="private">üîí Priv√©s</button>
                </div>
            </div>

            <!-- Writings Grid -->
            <div class="writings-grid" id="writingsGrid">
                <!-- Writings will be inserted here -->
            </div>

            <!-- Empty State -->
            <div class="empty-state hidden" id="emptyState">
                <div class="empty-icon">‚úçÔ∏è</div>
                <h2>Aucun √©crit pour le moment</h2>
                <p>Abonnez-vous √† des √©crivains pour voir leurs √©crits ici.</p>
                <button class="btn btn-primary" id="discoverWritersBtn">D√©couvrir des √©crivains</button>
            </div>
        </section>

        <!-- Write/Edit Page (Admin Only) -->
        <section id="page-write" class="page">
            <div class="editor-container">
                <div class="editor-header">
                    <button class="btn btn-ghost back-btn" data-page="home">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M19 12H5M12 19l-7-7 7-7" />
                        </svg>
                        Retour
                    </button>
                    <div class="editor-actions">
                        <button class="btn btn-ghost" id="previewToggle">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                                <circle cx="12" cy="12" r="3" />
                            </svg>
                            Aper√ßu
                        </button>
                        <button class="btn btn-primary" id="saveWriting">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z" />
                                <polyline points="17 21 17 13 7 13 7 21" />
                                <polyline points="7 3 7 8 15 8" />
                            </svg>
                            Sauvegarder
                        </button>
                    </div>
                </div>

                <div class="editor-meta">
                    <input type="text" id="writingTitle" class="title-input" placeholder="Titre de votre √©crit..."
                        maxlength="100">

                    <div class="meta-row">
                        <div class="meta-field">
                            <label>Cat√©gorie</label>
                            <select id="writingCategory" class="select-input">
                                <option value="poetry">Po√©sie</option>
                                <option value="fiction">Fiction</option>
                                <option value="essay">Essai</option>
                                <option value="reflection">R√©flexion</option>
                                <option value="other">Autre</option>
                            </select>
                        </div>
                        <div class="meta-field">
                            <label>Visibilit√©</label>
                            <div class="toggle-group">
                                <button class="toggle-btn active" data-visibility="private">
                                    üîí Priv√©
                                </button>
                                <button class="toggle-btn" data-visibility="public">
                                    üåç Public
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="meta-field tags-field">
                        <label>Tags</label>
                        <div class="tags-input-container">
                            <div class="tags-list" id="tagsList"></div>
                            <input type="text" id="tagsInput" class="tags-input"
                                placeholder="Ajouter un tag (Entr√©e pour valider)">
                        </div>
                    </div>
                </div>

                <div class="editor-body">
                    <div class="editor-pane" id="editorPane">
                        <div class="toolbar">
                            <button class="toolbar-btn" data-action="bold"
                                title="Gras (Ctrl+B)"><strong>G</strong></button>
                            <button class="toolbar-btn" data-action="italic"
                                title="Italique (Ctrl+I)"><em>I</em></button>
                            <span class="toolbar-divider"></span>
                            <button class="toolbar-btn" data-action="h1" title="Titre 1">H1</button>
                            <button class="toolbar-btn" data-action="h2" title="Titre 2">H2</button>
                            <button class="toolbar-btn" data-action="h3" title="Titre 3">H3</button>
                            <span class="toolbar-divider"></span>
                            <button class="toolbar-btn" data-action="quote" title="Citation">‚ùù</button>
                            <button class="toolbar-btn" data-action="list" title="Liste">‚Ä¢</button>
                        </div>
                        <textarea id="writingContent" class="editor-textarea"
                            placeholder="Commencez √† √©crire... (Markdown support√©)"></textarea>
                    </div>
                    <div class="preview-pane hidden" id="previewPane">
                        <div class="preview-content" id="previewContent"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Read Page -->
        <section id="page-read" class="page">
            <article class="reading-container">
                <button class="btn btn-ghost back-btn" data-page="home">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M19 12H5M12 19l-7-7 7-7" />
                    </svg>
                    Retour √† la biblioth√®que
                </button>

                <header class="reading-header">
                    <div class="reading-meta">
                        <span class="reading-category" id="readCategory"></span>
                        <span class="reading-date" id="readDate"></span>
                        <span class="reading-visibility" id="readVisibility"></span>
                    </div>
                    <h1 class="reading-title" id="readTitle"></h1>
                    <div class="reading-tags" id="readTags"></div>
                </header>

                <div class="reading-content prose" id="readContent"></div>

                <div class="reading-author" id="readAuthor"></div>

                <footer class="reading-footer">
                    <button class="btn btn-ghost" id="editWritingBtn">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" />
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" />
                        </svg>
                        Modifier
                    </button>
                    <button class="btn btn-ghost btn-danger" id="deleteWritingBtn">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="3 6 5 6 21 6" />
                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" />
                        </svg>
                        Supprimer
                    </button>
                </footer>
            </article>
        </section>

        <!-- Profile Page (Admin Only) -->
        <section id="page-profile" class="page">
            <div class="profile-container">
                <div class="profile-header">
                    <div class="profile-avatar" id="profileAvatar">I</div>
                    <div class="profile-info">
                        <span class="role-badge" id="roleBadge">‚úçÔ∏è √âcrivain</span>
                        <input type="text" class="profile-name" id="profileName" placeholder="Nom affich√©"
                            maxlength="50">
                        <input type="text" class="profile-username" id="profileUsername" placeholder="@pseudo"
                            maxlength="30" disabled>
                        <textarea class="profile-bio" id="profileBio" placeholder="√âcrivez votre biographie..."
                            maxlength="500"></textarea>
                        <button class="btn btn-primary btn-sm" id="saveProfileBtn">Sauvegarder le profil</button>
                    </div>
                </div>

                <div class="profile-stats">
                    <div class="stat">
                        <span class="stat-value" id="statTotal">0</span>
                        <span class="stat-label">√âcrits</span>
                    </div>
                    <div class="stat">
                        <span class="stat-value" id="statPublic">0</span>
                        <span class="stat-label">Publics</span>
                    </div>
                    <div class="stat">
                        <span class="stat-value" id="statPrivate">0</span>
                        <span class="stat-label">Priv√©s</span>
                    </div>
                </div>

                <div class="profile-section">
                    <h2>Mes √âcrits</h2>
                    <div class="writings-grid" id="myWritingsGrid"></div>
                    <div class="empty-state small" id="noMyWritings">
                        <p>Vous n'avez pas encore publi√© d'√©crits.</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <!-- Delete Confirmation Modal -->
    <div class="modal-overlay" id="deleteModal">
        <div class="modal">
            <h3>Supprimer cet √©crit ?</h3>
            <p>Cette action est irr√©versible. L'√©crit sera d√©finitivement supprim√©.</p>
            <div class="modal-actions">
                <button class="btn btn-ghost" id="cancelDelete">Annuler</button>
                <button class="btn btn-danger" id="confirmDelete">Supprimer</button>
            </div>
        </div>
    </div>

    <!-- Auth Modal -->
    <div class="modal-overlay" id="authModal">
        <div class="modal auth-modal">
            <button class="modal-close" id="closeAuthModal">&times;</button>
            <div class="auth-tabs">
                <button class="auth-tab active" id="loginTab">Connexion</button>
                <button class="auth-tab" id="signupTab">Inscription</button>
            </div>

            <!-- Login Form -->
            <form id="loginForm" class="auth-form">
                <div class="form-group">
                    <label for="loginEmail">Email</label>
                    <input type="email" id="loginEmail" placeholder="votre@email.com" required autocomplete="email">
                </div>
                <div class="form-group">
                    <label for="loginPassword">Mot de passe</label>
                    <input type="password" id="loginPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required
                        autocomplete="current-password">
                </div>
                <button type="submit" class="btn btn-primary btn-full">Se connecter</button>
            </form>

            <!-- Signup Form -->
            <form id="signupForm" class="auth-form hidden">
                <div class="form-group">
                    <label for="signupEmail">Email</label>
                    <input type="email" id="signupEmail" placeholder="votre@email.com" required autocomplete="email">
                </div>
                <div class="form-group">
                    <label for="signupUsername">Pseudo (unique)</label>
                    <input type="text" id="signupUsername" placeholder="mon_pseudo" required minlength="3"
                        maxlength="20" autocomplete="username">
                </div>
                <div class="form-group">
                    <label for="signupDisplayName">Nom affich√©</label>
                    <input type="text" id="signupDisplayName" placeholder="Votre Nom" required autocomplete="name">
                </div>
                <div class="form-group">
                    <label for="signupPassword">Mot de passe</label>
                    <input type="password" id="signupPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required minlength="6"
                        autocomplete="new-password">
                    <div class="password-strength" id="passwordStrength">
                        <div class="strength-bar" id="strengthBar"></div>
                        <span class="strength-text" id="strengthText"></span>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary btn-full">Cr√©er mon compte</button>
            </form>
        </div>
    </div>

    <!-- Newsletter Footer -->
    <footer class="newsletter-footer">
        <div class="newsletter-container">
            <div class="newsletter-content">
                <div class="newsletter-text">
                    <h3>üì¨ Restez inform√©</h3>
                    <p>Recevez les nouveaux √©crits directement dans votre bo√Æte mail.</p>
                </div>
                <form class="newsletter-form" id="newsletterForm">
                    <div class="newsletter-input-group">
                        <input type="email" id="newsletterEmail" placeholder="votre@email.com" required>
                        <button type="submit" class="btn btn-primary" id="subscribeBtn">
                            <span class="btn-text">S'abonner</span>
                            <span class="btn-loading" style="display:none;">...</span>
                        </button>
                    </div>
                </form>
            </div>
            <div class="footer-bottom">
                <p>¬© <span id="copyrightYear">2024</span> Isaiah ‚Äî Dis-le. Gu√©ris.</p>
                <script>document.getElementById('copyrightYear').textContent = new Date().getFullYear();</script>
            </div>
        </div>
    </footer>

    <!-- Cookie Consent Banner -->
    <div id="cookieBanner" class="cookie-banner hidden">
        <div class="cookie-content">
            <h3>üç™ Cookies & Confidentialit√©</h3>
            <p>
                Nous utilisons des cookies analytiques (Google Analytics) pour comprendre comment vous utilisez Isaiah
                et
                am√©liorer l'exp√©rience. Aucune donn√©e personnelle n'est vendue.
            </p>
        </div>
        <div class="cookie-actions">
            <button id="cookieRefuse" class="btn btn-ghost btn-sm">Refuser</button>
            <button id="cookieAccept" class="btn btn-primary btn-sm">Accepter</button>
        </div>
    </div>

    <script src="app.js?v=2.0.1"></script>
</body>

</html>